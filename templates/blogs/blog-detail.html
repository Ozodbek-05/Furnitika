{% extends 'layout/base.html' %}
{% load static %}
{% load i18n %}
{% load my_tags %}
{% block title %}{{ blog.title }}{% endblock %}
{% block body_id %}blog-detail{% endblock %}
{% block body_class %}blog{% endblock %}
{% block content %}
    <div class="main-content">
        <div id="wrapper-site">
            <div id="content-wrapper">
                <div id="main">
                    <div class="page-home">
                        <!-- breadcrumb -->
                        <nav class="breadcrumb-bg">
                            <div class="container no-index">
                                <div class="breadcrumb">
                                    <ol>
                                        <li>
                                            <a href="{% url 'blogs:blogs_home' %}">
                                                <span>{% trans 'Home' %}</span>
                                            </a>
                                        </li>
                                        {% if parent_category %}
                                        <li>
                                            <a href="{% url 'blogs:blog_filter' 'category' parent_category.id %}">
                                                <span>{{ parent_category.title }}</span>
                                            </a>
                                        </li>
                                        {% endif %}
                                        {% if category %}
                                        <li>
                                            <a href="{% url 'blogs:blog_filter' 'category' category.id %}">
                                                <span>{{ category.title }}</span>
                                            </a>
                                        </li>
                                        {% endif %}
                                        <li>
                                            <span>{{ blog.title }}</span>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </nav>
                        <div class="container">
                            <div class="content">
                                <div class="row">
                                    <div class="sidebar-3 sidebar-collection col-lg-3 col-md-3 col-sm-4">
                                        {% include 'blogs/blog-sidebar.html' %}
                                    </div>
                                    <div class="col-sm-8 col-lg-9 col-md-9 flex-xs-first main-blogs">
                                        <h3>{{ blog.title }}</h3>
                                        <div class="hover-after">
                                            {% if blog.image %}
                                            <img src="{{ blog.image.url }}" alt="{{ blog.title }}" class="img-fluid">
                                            {% else %}
                                            <img src="{% static 'img/blog/placeholder.jpg' %}" alt="No image" class="img-fluid">
                                            {% endif %}
                                        </div>
                                        <div class="late-item">
                                            {{ blog.content|safe }}
                                            <div class="border-detail">
                                                <p class="post-info float-left">
                                                    <span>{{ blog.created_at|timesince }} ago</span>
                                                    <span>{{ comments.count }} Comments</span>
                                                    <span>{{ blog.author.username|upper|default:"ADMIN" }}</span>
                                                </p>
                                            </div>
                                        </div>

                                        {% if blog.author %}
                                        <div class="admin">
                                            <img src="{% static 'img/blog/user.jpg' %}" alt="img" class="float-left right">
                                            <div class="info">
                                                <p>
                                                    <a href="#">
                                                        <span class="content-title">
                                                            {{ blog.author.full_name|default:"ADMIN" }}
                                                        </span>
                                                    </a>
                                                    <span>{% trans 'Blog Author' %}</span>
                                                </p>
                                                <p class="descript">
                                                    {{ blog.short_content|default:"Experienced content creator and blogger."|safe }}
                                                </p>
                                            </div>
                                        </div>
                                        {% endif %}

                                        <div class="related">
                                            <h2 class="title-block">{% trans 'Related Blogs' %}</h2>
                                            <div class="main-blogs">
                                                <div class="row">
                                                    {% for rb in related_blogs %}
                                                    <div class="col-md-4">
                                                        <div class="hover-after">
                                                            <a href="{% url 'blogs:detail' rb.id %}">
                                                                {% if rb.image %}
                                                                <img src="{{ rb.image.url }}"
                                                                     alt="{{ rb.title }}"
                                                                     class="img-fluid"
                                                                     style="height: 170px; width:100%; object-fit:cover;">
                                                                {% else %}
                                                                <img src="{% static 'img/blog/placeholder.jpg' %}"
                                                                     alt="No image"
                                                                     class="img-fluid"
                                                                     style="height: 170px; width:100%; object-fit:cover;">
                                                                {% endif %}
                                                            </a>
                                                        </div>
                                                        <div class="late-item">
                                                            <p class="content-title">
                                                                <a href="{% url 'blogs:detail' rb.id %}">{{ rb.title|truncatewords:5 }}</a>
                                                            </p>
                                                            <p class="description">{{ rb.content|striptags|truncatewords:15 }}</p>
                                                        </div>
                                                    </div>
                                                    {% empty %}
                                                    <div class="col-md-12">
                                                        <p style="text-align:center;color:#999;padding:20px;">{% trans 'No related blogs found.' %}</p>
                                                    </div>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        </div>

                                        <div class="reply late-item">
                                            <div class="blog-comment" id="blog-comment">
                                                <h2 class="title-block">{% trans 'Comments' %} ({{ comments.count }})</h2>
                                            </div>

                                            {% for comment in comments %}
                                            <div class="{% if forloop.first %}blog-comment{% else %}blog-comment margin-right-comment{% endif %}">
                                                <div class="avatar">
                                                    <img src="{% static 'img/blog/user1.jpg' %}" alt="{{ comment.name }}" class="float-left {% if forloop.first %}right{% endif %}">
                                                </div>
                                                <div class="comment-content">
                                                    <p class="user-title">
                                                        <a href="{% if comment.website %}{{ comment.website }}{% else %}#{% endif %}" target="_blank">
                                                            {{ comment.name|upper }}
                                                        </a>
                                                        <span class="time">
                                                            Posted on {{ comment.created_at|date:"M d, Y \a\t g:ia" }}
                                                        </span>
                                                    </p>
                                                    <p class="content-comment">{{ comment.message }}</p>
                                                </div>
                                            </div>
                                            {% empty %}
                                            <div style="text-align:center;padding:30px;color:#999;">
                                                <p>{% trans 'No comments yet. Be the first to comment!' %}</p>
                                            </div>
                                            {% endfor %}
                                        </div>

                                        <div class="submit-comment" id="respond">
                                            <h2 class="title-block">{% trans 'Submit comment' %}</h2>

                                            {% if messages %}
                                            <div style="margin-bottom:20px;">
                                                {% for message in messages %}
                                                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert" style="padding:15px;border-radius:5px;margin-bottom:10px;">
                                                    {{ message }}
                                                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                {% endfor %}
                                            </div>
                                            {% endif %}

                                            <div id="commentInput">
                                                <form action="" method="post" id="commentform">
                                                    {% csrf_token %}
                                                    <div class="row">
                                                        <div class="form-group col col-sm-12 col-md-4">
                                                            <input type="text" class="inputName form-control" name="name" placeholder="Your Name *" required>
                                                        </div>
                                                        <div class="form-group col col-sm-12 col-md-4">
                                                            <input type="email" class="inputMail form-control" name="email" placeholder="Your E-mail *" required>
                                                        </div>
                                                        <div class="form-group col col-sm-12 col-md-4">
                                                            <input type="url" class="form-control" name="website" placeholder="Your Website">
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="form-group col col-md-12">
                                                            <textarea tabindex="4" class="inputContent form-control grey" rows="10" name="message" placeholder="Your Message" required></textarea>
                                                        </div>
                                                    </div>
                                                    <div class="submit">
                                                        <input type="submit" name="addComment" id="submitComment" class="btn btn-default" value="Send Message">
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}